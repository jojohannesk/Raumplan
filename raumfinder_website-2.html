<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Freie Räume – Live</title>
  <style>
    body { font-family: Arial, sans-serif; background: #f4f4f4; padding: 20px; }
    .box { background: white; padding: 20px; border-radius: 12px; max-width: 600px; margin: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.1);}    
    h1 { font-size: 28px; margin-bottom: 10px; }
    #freeRooms { font-size: 22px; font-weight: bold; color: #2a7; margin-top: 15px; }
    .timeDisplay { font-size: 18px; margin-top: 10px; }
  </style>
</head>
<body>
  <div class="box">
    <h1>Welche Räume sind gerade frei?</h1>
    <div class="timeDisplay" id="timeNow"></div> <br>
    <label><input type="checkbox" id="pianoOnly"> Nur Räume mit Flügel anzeigen</label>
    <div id="freeRooms">Lade...</div>
  </div>


<script>
// --- DATA: FREE ROOMS (only Monday for now — extendable) ---
// Structure: "Day -> TimeRange -> FreeRooms"
const schedule = {
  "Monday": {
    "09:00-09:30": "R4, R5, R11, R12, R13, R16, R17",
    "09:30-10:00": "R4, R5, R11, R12, R13, R16, R17",
    "10:00-10:30": "R4, R5, R11, R12, R13, R16, R17",
    "10:30-11:00": "R4, R5, R11, R12, R13, R16, R17",
    "11:00-11:30": "R4, R5, R11, R12, R13, R16, R17",
    "11:30-12:00": "R4, R5, R11, R12, R13, R16, R17",
    "12:00-12:30": "R4, R5, R11, R12, R13, R16, R17",
    "12:30-13:00": "R4, R5, R11, R12, R13, R15, R16, R17",
    "13:00-13:30": "R4, R5, R11, R12, R13, R15, R16, R17",
    "13:30-14:00": "R4, R5, R11, R13, R15, R17",
    "14:00-14:30": "R4, R5, R13, R15, R16, R17",
    "14:30-15:00": "R5, R13, R15, R17",
    "15:00-15:30": "R5, R13, R15, R17",
    "15:30-16:00": "R5, R13, R15, R17",
    "16:00-16:30": "R5, R13, R17",
    "16:30-17:00": "R5, R17",
    "17:00-17:30": "R5, R17",
    "17:30-18:00": "R5, R15, R17",
    "18:00-18:30": "R5, R15, R16, R17",
    "18:30-19:00": "R5, R11, R12, R15, R16, R17",
    "19:00-19:30": "R5, R11, R13, R15, R16, R17",
    "19:30-20:00": "R5, R11, R13, R15, R16, R17",
    "20:00-20:30": "R5, R11, R13, R15, R16, R17",
    "20:30-21:00": "R5, R11, R12, R13, R15, R16, R17",
    "21:00-21:30": "R4, R5, R11, R12, R13, R15, R16, R17",
    "21:30-22:00": "R4, R5, R11, R12, R13, R15, R16, R17"
  },
    "Tuesday": {
    "09:00-09:30": "R4, R5, R11, R12, R13, R16, R17",
    "09:30-10:00": "R4, R5, R11, R12, R13, R16, R17",
    "10:00-10:30": "R4, R5, R11, R12, R13, R16, R17",
    "10:30-11:00": "R5, R11, R12, R13, R16, R17",
    "11:00-11:30": "R5, R11, R12, R13, R16, R17",
    "11:30-12:00": "R5, R11, R12, R13, R16, R17",
    "12:00-12:30": "R4, R5, R11, R12, R13, R16, R17",
    "12:30-13:00": "R4, R5, R11, R12, R13, R15, R16, R17",
    "13:00-13:30": "R4, R5, R12, R13, R15, R16, R17",
    "13:30-14:00": "R4, R5, R13, R15, R16, R17",
    "14:00-14:30": "R4, R5, R13, R15, R16, R17",
    "14:30-15:00": "R4, R5, R13, R15, R17",
    "15:00-15:30": "R4, R13, R15, R17",
    "15:30-16:00": "R4, R13, R15, R17",
    "16:00-16:30": "R4, R13, R15, R17",
    "16:30-17:00": "R4, R13, R15, R17",
    "17:00-17:30": "R4, R13, R15, R17",
    "17:30-18:00": "R4, R5, R13, R15, R17",
    "18:00-18:30": "R4, R5, R11, R13, R15, R17",
    "18:30-19:00": "R5, R11, R13, R15, R16, R17",
    "19:00-19:30": "R5, R11, R13, R15, R16",
    "19:30-20:00": "R5, R11, R12, R13, R15, R16",
    "20:00-20:30": "R5, R11, R12, R13, R15, R16",
    "20:30-21:00": "R5, R11, R12, R13, R15, R16, R17",
    "21:00-21:30": "R5, R11, R12, R13, R15, R16, R17",
    "21:30-22:00": "R5, R11, R12, R13, R15, R16, R17"
  },
    "Wednesday": {
    "09:00-09:30": "R4, R11, R12, R13, R16, R17",
    "09:30-10:00": "R4, R11, R12, R13, R16, R17",
    "10:00-10:30": "R4, R11, R12, R13, R16, R17",
    "10:30-11:00": "R4, R11, R12, R13, R16, R17",
    "11:00-11:30": "R4, R5, R11, R12, R13, R16, R17",
    "11:30-12:00": "R4, R5, R11, R12, R13, R16, R17",
    "12:00-12:30": "R4, R5, R11, R12, R13, R16, R17",
    "12:30-13:00": "R4, R11, R12, R13, R16, R17",
    "13:00-13:30": "R4, R16",
    "13:30-14:00": "R4, R5, R16",
    "14:00-14:30": "R4, R5, R16",
    "14:30-15:00": "R4, R5",
    "15:00-15:30": "R4",
    "15:30-16:00": "R4",
    "16:00-16:30": "",
    "16:30-17:00": "",
    "17:00-17:30": "",
    "17:30-18:00": "R5",
    "18:00-18:30": "R4",
    "18:30-19:00": "R4, R12, R15, R16",
    "19:00-19:30": "R4, R11, R12, R13, R16, R17",
    "19:30-20:00": "R4, R11, R12, R13, R16, R17",
    "20:00-20:30": "R4, R11, R12, R13, R16, R17",
    "20:30-21:00": "R11, R12, R13, R15, R16, R17",
    "21:00-21:30": "R11, R12, R13, R15, R16, R17",
    "21:30-22:00": "R11, R12, R13, R15, R16, R17"
  },
      "Thursday": {
    "09:00-09:30": "R4, R5, R11, R12, R13, R15, R16, R17",
    "09:30-10:00": "R4, R5, R11, R12, R13, R15, R16, R17",
    "10:00-10:30": "R4, R5,R11, R12, R13, R16, R17",
    "10:30-11:00": "R4, R5, R11, R12, R13, R16, R17",
    "11:00-11:30": "R4, R5, R11, R12, R13, R16, R17",
    "11:30-12:00": "R4, R5, R11, R12, R13, R16, R17",
    "12:00-12:30": "R4, R5, R11, R12, R13, R16, R17",
    "12:30-13:00": "R4, R5, R11, R13, R16, R17",
    "13:00-13:30": "R4, R5, R11, R16, R17",
    "13:30-14:00": "R4, R5, R11, R16, R17",
    "14:00-14:30": "R4, R5, R16, R17",
    "14:30-15:00": "R4, R5, R17",
    "15:00-15:30": "R5, R17",
    "15:30-16:00": "R5, R17",
    "16:00-16:30": "R5, R17",
    "16:30-17:00": "R5, R17",
    "17:00-17:30": "R5, R17",
    "17:30-18:00": "R5, R17",
    "18:00-18:30": "R5, R12, R17",
    "18:30-19:00": "R5, R12, R16, R17",
    "19:00-19:30": "R5, R11, R12, R13, R16, R17",
    "19:30-20:00": "R5, R11, R12, R13, R16, R17",
    "20:00-20:30": "R4, R5, R11, R12, R13, R16, R17",
    "20:30-21:00": "R5, R11, R12, R13, R16, R17",
    "21:00-21:30": "R5, R11, R12, R13, R16, R17",
    "21:30-22:00": "R5, R11, R12, R13, R16, R17"
  },
      "Friday": {
    "09:00-09:30": "R4, R11, R12, R13, R15, R16, R17",
    "09:30-10:00": "R4, R11, R12, R13, R15, R16, R17",
    "10:00-10:30": "R4, R11, R12, R13, R15, R16, R17",
    "10:30-11:00": "R4, R11, R12, R13, R15, R16, R17",
    "11:00-11:30": "R4, R11, R12, R13, R15, R16, R17",
    "11:30-12:00": "R4, R5, R11, R12, R13, R15, R16, R17",
    "12:00-12:30": "R4, R5, R11, R12, R16, R17",
    "12:30-13:00": "R4, R5, R12, R17",
    "13:00-13:30": "R4, R5, R12, R17",
    "13:30-14:00": "R4, R5, R12, R17",
    "14:00-14:30": "R4, R12, R17",
    "14:30-15:00": "R12, R17",
    "15:00-15:30": "R17",
    "15:30-16:00": "R17",
    "16:00-16:30": "R5, R12, R17",
    "16:30-17:00": "R5, R12, R17 ",
    "17:00-17:30": "R5, R12, R17 ",
    "17:30-18:00": "R5, R12, R17 ",
    "18:00-18:30": "R5, R12, R17",
    "18:30-19:00": "R5, R11, R12, R17",
    "19:00-19:30": "R5, R11, R12, R13, R17",
    "19:30-20:00": "R5, R11, R12, R13, R17",
    "20:00-20:30": "R5, R11, R12, R13, R16, R17",
    "20:30-21:00": "R5, R11, R12, R13, R16, R17",
    "21:00-21:30": "R4, R5, R11, R12, R13, R16, R17",
    "21:30-22:00": "R4, R5, R11, R12, R13, R16, R17"
  }
};

// Parse time "HH:MM" → minutes
function toMinutes(t) {
  const [h, m] = t.split(":").map(Number);
  return h * 60 + m;
}

// Find current slot
function findCurrentRooms() {
  const now = new Date();
  const dayNames = ["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
  const day = dayNames[now.getDay()];

  const minutes = now.getHours() * 60 + now.getMinutes();

  document.getElementById("timeNow").textContent =
    `Es ist gerade ${now.toLocaleTimeString([], {hour: '2-digit', minute: '2-digit'})}, ${day}.`;

  if (!schedule[day]) {
    document.getElementById("freeRooms").textContent = "Keine Daten für diesen Tag";
    return;
  }

  const entries = schedule[day];

  for (const range in entries) {
    const [start, end] = range.split("-");
    if (minutes >= toMinutes(start) && minutes < toMinutes(end)) {
      const free = entries[range];
      document.getElementById("freeRooms").textContent =
        free ? `Jetzt frei: ${free}` : "Keine Räume frei";
      return;
    }
  }

  document.getElementById("freeRooms").textContent = "Außerhalb der Öffnungszeiten";
}

// Update every 20 seconds
findCurrentRooms();
setInterval(findCurrentRooms, 20000);
</script>
<br>
  <div class="box">
    <h2>Manuelle Abfrage</h2>
    <label><input type="checkbox" id="pianoOnlySingle"> Nur Räume mit Flügel anzeigen</label> <br><br>
    <label for="daySelect">Tag:</label>
    <select id="daySelect"></select>

  <label for="timeSelect">Uhrzeit:</label>
  <input type="time" id="timeSelect" step="1800"> <!-- step=1800 für 30-Minuten-Intervalle -->

  <button onclick="manualCheck()">Prüfen</button>
  <div id="manualResult" style="margin-top: 10px; font-weight: bold;"></div>
</div>

<script>
// --- Fülle das Dropdown für die Tage ---
const daySelect = document.getElementById("daySelect");
const days = Object.keys(schedule);
days.forEach(d => {
  const option = document.createElement("option");
  option.value = d;
  option.textContent = d;
  daySelect.appendChild(option);
});

// --- Manuelle Abfrage ---
/* function manualCheck() {
  const day = daySelect.value;
  const time = document.getElementById("timeSelect").value; // HH:MM

  if (!time) {
    document.getElementById("manualResult").textContent = "Bitte Uhrzeit wählen";
    return;
  }

  const minutes = toMinutes(time);

  const entries = schedule[day];
  if (!entries) {
    document.getElementById("manualResult").textContent = "Keine Daten für diesen Tag";
    return;
  }

  for (const range in entries) {
    const [start, end] = range.split("-");
    if (minutes >= toMinutes(start) && minutes < toMinutes(end)) {
      const free = entries[range];
      document.getElementById("manualResult").textContent =
        free ? `Zu dieser Zeit frei: ${free}` : "Keine Räume frei";
      return;
    }
  }

  document.getElementById("manualResult").textContent = "Außerhalb der Öffnungszeiten";
} */
function manualCheck() {
  const day = daySelect.value;
  const time = document.getElementById("timeSelect").value; // HH:MM
  const pianoOnly = document.getElementById("pianoOnlySingle").checked;

  if (!time) {
    document.getElementById("manualResult").textContent = "Bitte Uhrzeit wählen";
    return;
  }

  const minutes = toMinutes(time);
  const entries = schedule[day];
  if (!entries) {
    document.getElementById("manualResult").textContent = "Keine Daten für diesen Tag";
    return;
  }

  for (const range in entries) {
    const [start, end] = range.split("-");
    if (minutes >= toMinutes(start) && minutes < toMinutes(end)) {
      let free = entries[range] ? entries[range].split(", ").map(r => r.trim()) : [];

      // Räume filtern nach Flügel, falls aktiviert
      if (pianoOnly) {
        free = free.filter(r => pianoRooms[r]);
      }

      document.getElementById("manualResult").textContent =
        free.length > 0 ? `Zu dieser Zeit frei: ${free.join(", ")}` : "Keine Räume frei";
      return;
    }
  }

  document.getElementById("manualResult").textContent = "Außerhalb der Öffnungszeiten";
}

</script>
<br>
<!-- Zeitfenster -->
<div class="box">
  <h2>Zeitfenster prüfen</h2>
<label><input type="checkbox" id="pianoOnlySingle"> Nur Räume mit Flügel anzeigen</label> <br><br>

  <label for="daySelectWindow">Tag:</label>
  <select id="daySelectWindow"></select>

  <label for="startTime">Startzeit:</label>
  <input type="time" id="startTime" step="1800">

  <label for="endTime">Endzeit:</label>
  <input type="time" id="endTime" step="1800">

  <button onclick="checkTimeWindow()">Zeitfenster prüfen</button>
  <div id="windowResult" style="margin-top: 10px; font-weight: bold;"></div>
</div>

<script>
// --- Fülle das Dropdown für alle Tage ---
const daySelectWindow = document.getElementById("daySelectWindow");
days.forEach(d => {
  const option = document.createElement("option");
  option.value = d;
  option.textContent = d;
  daySelectWindow.appendChild(option);
});

// --- Funktion: Räume im Zeitfenster prüfen ---
/* function checkTimeWindow() {
  const day = daySelectWindow.value;
  const startTime = document.getElementById("startTime").value;
  const endTime = document.getElementById("endTime").value;

  if (!startTime || !endTime) {
    document.getElementById("windowResult").textContent = "Bitte Start- und Endzeit wählen";
    return;
  }

  const startMinutes = toMinutes(startTime);
  const endMinutes = toMinutes(endTime);

  if (startMinutes >= endMinutes) {
    document.getElementById("windowResult").textContent = "Endzeit muss nach Startzeit liegen";
    return;
  }

  const entries = schedule[day];
  if (!entries) {
    document.getElementById("windowResult").textContent = "Keine Daten für diesen Tag";
    return;
  }

  // Schnittmenge der freien Räume über alle Slots im gewählten Zeitraum
 let freeRoomsSet = null;

  for (const range in entries) {
    const [slotStart, slotEnd] = range.split("-");
    const slotStartMin = toMinutes(slotStart);
    const slotEndMin = toMinutes(slotEnd);

    // Prüfen, ob dieser Slot innerhalb des gewählten Zeitfensters liegt
    if (slotEndMin <= startMinutes || slotStartMin >= endMinutes) continue;

    const slotRooms = entries[range] ? entries[range].split(", ").map(r => r.trim()) : [];
    
    if (freeRoomsSet === null) {
      freeRoomsSet = new Set(slotRooms);
    } else {
      freeRoomsSet = new Set(slotRooms.filter(r => freeRoomsSet.has(r)));
    }
  }

  const result = freeRoomsSet && freeRoomsSet.size > 0 ? Array.from(freeRoomsSet).join(", ") : "Keine Räume komplett frei";
  document.getElementById("windowResult").textContent = `Im gewählten Zeitraum frei: ${result}`;
} */

function checkTimeWindow() {
  const day = daySelectWindow.value;
  const startTime = document.getElementById("startTime").value;
  const endTime = document.getElementById("endTime").value;
  const pianoOnly = document.getElementById("pianoOnly").checked;

  if (!startTime || !endTime) {
    document.getElementById("windowResult").textContent = "Bitte Start- und Endzeit wählen";
    return;
  }

  const startMinutes = toMinutes(startTime);
  const endMinutes = toMinutes(endTime);

  if (startMinutes >= endMinutes) {
    document.getElementById("windowResult").textContent = "Endzeit muss nach Startzeit liegen";
    return;
  }

  const entries = schedule[day];
  if (!entries) {
    document.getElementById("windowResult").textContent = "Keine Daten für diesen Tag";
    return;
  }

  let freeRoomsSet = null;

  for (const range in entries) {
    const [slotStart, slotEnd] = range.split("-");
    const slotStartMin = toMinutes(slotStart);
    const slotEndMin = toMinutes(slotEnd);

    if (slotEndMin <= startMinutes || slotStartMin >= endMinutes) continue;

    // Räume filtern nach Flügel, falls aktiviert
    let slotRooms = entries[range] ? entries[range].split(", ").map(r => r.trim()) : [];
    if (pianoOnly) {
      slotRooms = slotRooms.filter(r => pianoRooms[r]);
    }

    if (freeRoomsSet === null) {
      freeRoomsSet = new Set(slotRooms);
    } else {
      freeRoomsSet = new Set(slotRooms.filter(r => freeRoomsSet.has(r)));
    }
  }

  const result = freeRoomsSet && freeRoomsSet.size > 0 ? Array.from(freeRoomsSet).join(", ") : "Keine Räume komplett frei";
  document.getElementById("windowResult").textContent = `Im gewählten Zeitraum frei: ${result}`;
}

</script>

<!--Filter Flügel oder nicht-->
<script>
const pianoRooms = {
  "R4": true,
  "R5": false,
  "R11": true,
  "R12": false,
  "R13": true,
  "R15": false,
  "R16": false,
  "R17": false
};
</script>


</body>
</html>
